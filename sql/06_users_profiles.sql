CREATE USER GYM_APP_ADMIN IDENTIFIED BY adminpass
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_TRAINER1 IDENTIFIED BY trainer1
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_TRAINER2 IDENTIFIED BY trainer2
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_MEMBER1  IDENTIFIED BY member1
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_MEMBER2  IDENTIFIED BY member2
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_MEMBER3  IDENTIFIED BY member3
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_REPORT   IDENTIFIED BY report1
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER GYM_GUEST    IDENTIFIED BY guest
  DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;

GRANT CREATE SESSION TO
  GYM_APP_ADMIN, GYM_TRAINER1, GYM_TRAINER2,
  GYM_MEMBER1, GYM_MEMBER2, GYM_MEMBER3,
  GYM_REPORT, GYM_GUEST;

ALTER USER GYM_APP_ADMIN QUOTA UNLIMITED ON users;
ALTER USER GYM_REPORT    QUOTA 10M       ON users;
ALTER USER GYM_TRAINER1  QUOTA 2M        ON users;
ALTER USER GYM_TRAINER2  QUOTA 2M        ON users;
ALTER USER GYM_MEMBER1   QUOTA 0M        ON users;
ALTER USER GYM_MEMBER2   QUOTA 0M        ON users;
ALTER USER GYM_MEMBER3   QUOTA 0M        ON users;
ALTER USER GYM_GUEST     QUOTA 0M        ON users;

CREATE PROFILE prof_gym_guest LIMIT
    SESSIONS_PER_USER     5
    IDLE_TIME             3
    CONNECT_TIME          15;

CREATE PROFILE prof_gym_work LIMIT
    CPU_PER_CALL          6000
    SESSIONS_PER_USER     1
    PASSWORD_LIFE_TIME    7
    FAILED_LOGIN_ATTEMPTS 10;

ALTER USER GYM_GUEST     PROFILE prof_gym_guest;
ALTER USER GYM_APP_ADMIN PROFILE prof_gym_work;
ALTER USER GYM_TRAINER1  PROFILE prof_gym_work;
ALTER USER GYM_TRAINER2  PROFILE prof_gym_work;
ALTER USER GYM_MEMBER1   PROFILE prof_gym_work;
ALTER USER GYM_MEMBER2   PROFILE prof_gym_work;
ALTER USER GYM_MEMBER3   PROFILE prof_gym_work;
ALTER USER GYM_REPORT    PROFILE prof_gym_work;

CREATE TABLE gym_audit_logon (
    id_audit      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username      VARCHAR2(30),
    session_id    VARCHAR2(50),
    host          VARCHAR2(100),
    logon_time    DATE,
    logout_time   DATE
);

CREATE OR REPLACE TRIGGER trg_gym_logon
AFTER LOGON ON DATABASE
DECLARE
    PRAGMA AUTONOMOUS_TRANSACTION;
BEGIN
    INSERT INTO gym_audit_logon(username, session_id, host, logon_time)
    VALUES (SYS_CONTEXT('USERENV','SESSION_USER'),
            SYS_CONTEXT('USERENV','SESSIONID'),
            SYS_CONTEXT('USERENV','HOST'),
            SYSDATE);
    COMMIT;
END;